<script src="js/d3.v3.min.js"></script>
<script src="js/topojson.v1.min.js"></script>
<script src="js/queue.v1.min.js"></script>
<script src="js/jquery-2.2.1.min.js"></script>
<script src="js/jquery-ui.min.js"></script>
<script src="js/d3.layout.cloud.js"></script>
<script src="js/d3.geo.projection.v0.min.js"></script>
<script src="js/geostats.min.js"></script>
<link href="css/style.css" rel="stylesheet" type="text/css" >
<link href="css/jquery-ui.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="css/colorbrewer.css">   


<html>
<head>
<meta charset="UTF-8">
</head>   
<body> 
<div id="header"></div>
<div id="menu"></div>
<div id="map"></div>
<div id="dialog"></div>
</body>    
</html>


<script>

function plotWordCloud(file) {

  var width = 800, height=400; 	
  var mytagsScale = d3.scale.linear().range([10,60]);
  var fill = d3.scale.category20();	

  d3.tsv(file, function(data){
	var mytags = data
	.filter(function(d){return +d.nb > 0;})
	.map(function(d){ return {text : d.word, size: +d.nb};})
	.sort(function(a,b){return d3.descending(a.size,b.size);})
	.slice(0,100);
  mytagsScale.domain([
	d3.min(mytags, function(d){return d.size}),
	d3.max(mytags, function(d){return d.size})
]);

  d3.layout.cloud().size([width, height])
      .words(mytags)
      .rotate(function() { return ~~(Math.random() * 2) * 90; })
      .font("Impact")
      .fontSize(function(d) { return mytagsScale(d.size); })
      .on("end", draw)
      .start();

	});

  function draw(words) {
    d3.select("#map").append("svg")
        .attr("width", width)
        .attr("height", height)
      .append("g")
        .attr("transform", "translate("+(width/2)+","+(height/2)+")")
      .selectAll("text")
        .data(words)
      .enter().append("text")
        .style("font-size", function(d) { return d.size + "px"; })
        .style("font-family", "Impact")
        .style("fill", function(d, i) { return fill(i); })
        .attr("text-anchor", "middle")
        .attr("transform", function(d) {
          return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
        })
        .text(function(d) { return d.text; });
  }
}

plotWordCloud("database/output/tagexample.tsv")

</script>
